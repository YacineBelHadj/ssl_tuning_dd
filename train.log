[2024-03-08 18:15:12,233][__main__][INFO] - Starting training script
[2024-03-08 18:15:12,233][__main__][INFO] - Setting environment variables
[2024-03-08 18:15:12,234][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 18:15:12,234][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 18:15:12,234][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 18:15:12,235][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 18:15:12,235][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 18:15:12,236][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 18:15:13,064][__main__][INFO] - Logging gpu info
[2024-03-08 18:15:13,065][__main__][INFO] - Setting seed
[2024-03-08 18:15:13,077][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 18:15:13,156][__main__][INFO] - Instantiating callbacks:
[2024-03-08 18:15:13,157][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 18:15:13,168][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 18:15:13,173][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 18:15:13,175][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 18:15:13,177][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 18:15:13,179][__main__][INFO] - Instantiating loggers:
[2024-03-08 18:15:13,180][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 18:15:14,277][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 18:15:14,685][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 18:15:14,929][__main__][INFO] - Starting training
[2024-03-08 18:16:11,022][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-15-11/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 18:16:11,821][__main__][INFO] - Training complete - Starting testing
[2024-03-08 18:16:33,695][__main__][INFO] - Logging model and its path
[2024-03-08 18:16:33,696][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/utils/utils.py", line 36, in wrap
    res = task_func(cfg=cfg)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/train.py", line 73, in train
    logger[0].log_artifact(best_model_path)
AttributeError: 'CometLogger' object has no attribute 'log_artifact'
[2024-03-08 18:16:33,709][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-15-11
[2024-03-08 18:16:33,709][src.utils.utils][INFO] - Closing loggers...
[2024-03-08 18:20:28,994][__main__][INFO] - Starting training script
[2024-03-08 18:20:28,995][__main__][INFO] - Setting environment variables
[2024-03-08 18:20:28,996][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 18:20:29,005][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 18:20:29,005][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 18:20:29,005][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 18:20:29,005][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 18:20:29,007][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 18:20:29,745][__main__][INFO] - Logging gpu info
[2024-03-08 18:20:29,746][__main__][INFO] - Setting seed
[2024-03-08 18:20:29,757][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 18:20:29,839][__main__][INFO] - Instantiating callbacks:
[2024-03-08 18:20:29,840][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 18:20:29,850][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 18:20:29,856][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 18:20:29,858][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 18:20:29,860][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 18:20:29,863][__main__][INFO] - Instantiating loggers:
[2024-03-08 18:20:29,864][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 18:20:30,839][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 18:20:31,265][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 18:20:31,514][__main__][INFO] - Starting training
[2024-03-08 18:21:24,962][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-20-28/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 18:21:25,378][__main__][INFO] - Training complete - Starting testing
[2024-03-08 18:21:44,468][__main__][INFO] - Logging model and its path
[2024-03-08 18:21:46,230][__main__][INFO] - Instantiating Downstream task <<src.downstream.encoder_gmm.EncoderGMM>>
[2024-03-08 18:21:54,753][__main__][INFO] - Instantiating evaluator <<src.eval.evaluator.Evaluator>>
[2024-03-08 18:21:55,469][__main__][INFO] - Starting benchmark
[2024-03-08 18:34:51,169][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 153, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 182, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'individual_auc'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/utils/utils.py", line 36, in wrap
    res = task_func(cfg=cfg)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/train.py", line 88, in train
    sa_score = evaluator.evaluate_sa()
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/eval/evaluator.py", line 53, in evaluate_sa
    df_exploded = df.explode('individual_auc').reset_index(drop=True)
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/frame.py", line 9819, in explode
    result = df[columns[0]].explode()
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/frame.py", line 4090, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3809, in get_loc
    raise KeyError(key) from err
KeyError: 'individual_auc'
[2024-03-08 18:34:51,175][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-20-28
[2024-03-08 18:34:51,175][src.utils.utils][INFO] - Closing loggers...
[2024-03-08 18:37:46,387][__main__][INFO] - Starting training script
[2024-03-08 18:37:46,388][__main__][INFO] - Setting environment variables
[2024-03-08 18:37:46,389][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 18:37:46,389][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 18:37:46,389][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 18:37:46,389][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 18:37:46,390][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 18:37:46,390][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 18:37:47,042][__main__][INFO] - Logging gpu info
[2024-03-08 18:37:47,051][__main__][INFO] - Setting seed
[2024-03-08 18:37:47,054][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 18:37:47,126][__main__][INFO] - Instantiating callbacks:
[2024-03-08 18:37:47,127][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 18:37:47,135][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 18:37:47,139][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 18:37:47,141][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 18:37:47,143][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 18:37:47,145][__main__][INFO] - Instantiating loggers:
[2024-03-08 18:37:47,145][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 18:37:48,161][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 18:37:48,536][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 18:37:48,761][__main__][INFO] - Starting training
[2024-03-08 18:38:39,291][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-37-46/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 18:38:39,680][__main__][INFO] - Training complete - Starting testing
[2024-03-08 18:38:57,740][__main__][INFO] - Logging model and its path
[2024-03-08 18:38:59,603][__main__][INFO] - Instantiating Downstream task <<src.downstream.encoder_gmm.EncoderGMM>>
[2024-03-08 18:39:07,658][__main__][INFO] - Instantiating evaluator <<src.eval.evaluator.Evaluator>>
[2024-03-08 18:39:08,214][__main__][INFO] - Starting benchmark
[2024-03-08 18:50:35,281][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/utils/utils.py", line 36, in wrap
    res = task_func(cfg=cfg)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/train.py", line 88, in train
    sa_score = evaluator.evaluate_sa()
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/eval/evaluator.py", line 66, in evaluate_sa
    fig,ax=plot_boxplot(group,axis_label=['f_anomaly','anomaly_index'],title=name)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/eval/utils_plot.py", line 56, in plot_boxplot
    data.boxplot(column=yaxis, by=xaxis, ax=ax, )
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/plotting/_core.py", line 533, in boxplot_frame
    return plot_backend.boxplot_frame(
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/plotting/_matplotlib/boxplot.py", line 492, in boxplot_frame
    ax = boxplot(
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/plotting/_matplotlib/boxplot.py", line 438, in boxplot
    result = _grouped_plot_by_column(
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/plotting/_matplotlib/boxplot.py", line 299, in _grouped_plot_by_column
    grouped = data.groupby(by, observed=False)
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/frame.py", line 9156, in groupby
    return DataFrameGroupBy(
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/site-packages/pandas/core/groupby/grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'f_anomaly'
[2024-03-08 18:50:35,288][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-37-46
[2024-03-08 18:50:35,288][src.utils.utils][INFO] - Closing loggers...
[2024-03-08 18:52:40,045][__main__][INFO] - Starting training script
[2024-03-08 18:52:40,045][__main__][INFO] - Setting environment variables
[2024-03-08 18:52:40,046][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 18:52:40,047][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 18:52:40,047][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 18:52:40,047][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 18:52:40,047][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 18:52:40,048][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 18:52:40,664][__main__][INFO] - Logging gpu info
[2024-03-08 18:52:40,665][__main__][INFO] - Setting seed
[2024-03-08 18:52:40,667][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 18:52:40,728][__main__][INFO] - Instantiating callbacks:
[2024-03-08 18:52:40,729][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 18:52:40,737][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 18:52:40,740][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 18:52:40,742][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 18:52:40,743][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 18:52:40,744][__main__][INFO] - Instantiating loggers:
[2024-03-08 18:52:40,745][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 18:52:41,722][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 18:52:42,091][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 18:52:42,286][__main__][INFO] - Starting training
[2024-03-08 18:53:28,291][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-52-39/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 18:53:28,698][__main__][INFO] - Training complete - Starting testing
[2024-03-08 18:53:47,586][__main__][INFO] - Logging model and its path
[2024-03-08 18:53:49,484][__main__][INFO] - Instantiating Downstream task <<src.downstream.encoder_gmm.EncoderGMM>>
[2024-03-08 18:53:57,284][__main__][INFO] - Instantiating evaluator <<src.eval.evaluator.Evaluator>>
[2024-03-08 18:53:57,877][__main__][INFO] - Starting benchmark
[2024-03-08 19:06:46,816][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/utils/utils.py", line 36, in wrap
    res = task_func(cfg=cfg)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/train.py", line 88, in train
    sa_score = evaluator.evaluate_sa()
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/eval/evaluator.py", line 70, in evaluate_sa
    self.logger.experiment.log_image(buf, name=name)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/experiment.py", line 3599, in log_image
    upload_message = processor.process()
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/file_uploader.py", line 298, in process
    return self.process_io_object(user_input)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/file_uploader.py", line 680, in process_io_object
    extension = get_file_extension(self.name)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/utils.py", line 229, in get_file_extension
    ext = os.path.splitext(file_path)[1]
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/posixpath.py", line 118, in splitext
    p = os.fspath(p)
TypeError: expected str, bytes or os.PathLike object, not int
[2024-03-08 19:06:47,977][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_18-52-39
[2024-03-08 19:06:50,609][src.utils.utils][INFO] - Closing loggers...
[2024-03-08 19:13:21,541][__main__][INFO] - Starting training script
[2024-03-08 19:13:21,551][__main__][INFO] - Setting environment variables
[2024-03-08 19:13:21,552][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 19:13:21,553][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 19:13:21,553][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 19:13:21,553][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 19:13:21,554][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 19:13:21,554][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 19:13:22,311][__main__][INFO] - Logging gpu info
[2024-03-08 19:13:22,311][__main__][INFO] - Setting seed
[2024-03-08 19:13:22,323][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 19:13:22,410][__main__][INFO] - Instantiating callbacks:
[2024-03-08 19:13:22,410][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 19:13:22,421][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 19:13:22,425][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 19:13:22,426][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 19:13:22,428][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 19:13:22,431][__main__][INFO] - Instantiating loggers:
[2024-03-08 19:13:22,432][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 19:13:23,667][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 19:13:24,379][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 19:13:24,612][__main__][INFO] - Starting training
[2024-03-08 19:14:19,498][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_19-13-21/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 19:14:19,892][__main__][INFO] - Training complete - Starting testing
[2024-03-08 19:14:37,764][__main__][INFO] - Logging model and its path
[2024-03-08 19:14:39,564][__main__][INFO] - Instantiating Downstream task <<src.downstream.encoder_gmm.EncoderGMM>>
[2024-03-08 19:14:48,676][__main__][INFO] - Instantiating evaluator <<src.eval.evaluator.Evaluator>>
[2024-03-08 19:14:49,434][__main__][INFO] - Starting benchmark
[2024-03-08 19:30:05,652][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/utils/utils.py", line 36, in wrap
    res = task_func(cfg=cfg)
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/train.py", line 88, in train
    sa_score = evaluator.evaluate_sa()
  File "/home/yacine/Documents/PhD/Code/Package/ssl_dd/src/eval/evaluator.py", line 71, in evaluate_sa
    self.logger.experiment.log_image(buf, name=name)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/experiment.py", line 3599, in log_image
    upload_message = processor.process()
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/file_uploader.py", line 298, in process
    return self.process_io_object(user_input)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/file_uploader.py", line 680, in process_io_object
    extension = get_file_extension(self.name)
  File "/home/yacine/.local/lib/python3.10/site-packages/comet_ml/utils.py", line 229, in get_file_extension
    ext = os.path.splitext(file_path)[1]
  File "/home/yacine/miniconda3/envs/ssl_dd/lib/python3.10/posixpath.py", line 118, in splitext
    p = os.fspath(p)
TypeError: expected str, bytes or os.PathLike object, not int
[2024-03-08 19:30:05,666][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_19-13-21
[2024-03-08 19:30:05,669][src.utils.utils][INFO] - Closing loggers...
[2024-03-08 19:32:06,021][__main__][INFO] - Starting training script
[2024-03-08 19:32:06,021][__main__][INFO] - Setting environment variables
[2024-03-08 19:32:06,022][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2.db
[2024-03-08 19:32:06,022][src.utils.env_utils][INFO] - Set environment variable: PATH_DATA_V=/home/yacine/Documents/PhD/Code/GitProject/PBSHM_mdof/data/processed/SETTINGS1/settings2_vas.db
[2024-03-08 19:32:06,022][src.utils.env_utils][INFO] - Set environment variable: COMET_API_KEY=gd2RifnioVchODAgpk637Br8f
[2024-03-08 19:32:06,023][src.utils.env_utils][INFO] - Set environment variable: COMET_WORKSPACE=yacinebelhadj
[2024-03-08 19:32:06,023][src.utils.env_utils][INFO] - Set environment variable: COMET_PROJECT_NAME=SSL
[2024-03-08 19:32:06,023][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-03-08 19:32:06,195][__main__][INFO] - Logging gpu info
[2024-03-08 19:32:06,196][__main__][INFO] - Setting seed
[2024-03-08 19:32:06,207][__main__][INFO] - Instantiating datamodule <<src.data.psm.datamodule.DataModule>>
[2024-03-08 19:32:06,230][__main__][INFO] - Instantiating callbacks:
[2024-03-08 19:32:06,231][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-03-08 19:32:06,235][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-03-08 19:32:06,236][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-03-08 19:32:06,237][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2024-03-08 19:32:06,237][src.utils.instantiator][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2024-03-08 19:32:06,238][__main__][INFO] - Instantiating loggers:
[2024-03-08 19:32:06,238][src.utils.instantiator][INFO] - Instantiating logger <pytorch_lightning.loggers.comet.CometLogger>
[2024-03-08 19:32:06,719][__main__][INFO] - Instantiating Lit - model <<src.model.classifier.ClassifierModule>>
[2024-03-08 19:32:07,357][__main__][INFO] - Instantiating Trainer <<pytorch_lightning.Trainer>>
[2024-03-08 19:32:07,465][__main__][INFO] - Starting training
[2024-03-08 19:32:39,873][__main__][INFO] - Training complete- loading best model at :</home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_19-32-05/checkpoints/best-00-2.1647.ckpt>
[2024-03-08 19:32:40,307][__main__][INFO] - Training complete - Starting testing
[2024-03-08 19:32:52,673][__main__][INFO] - Logging model and its path
[2024-03-08 19:32:54,489][__main__][INFO] - Instantiating Downstream task <<src.downstream.encoder_gmm.EncoderGMM>>
[2024-03-08 19:32:59,568][__main__][INFO] - Instantiating evaluator <<src.eval.evaluator.Evaluator>>
[2024-03-08 19:32:59,793][__main__][INFO] - Starting benchmark
[2024-03-08 19:40:45,823][src.utils.utils][INFO] - Output dir: /home/yacine/Documents/PhD/Code/Package/ssl_dd/logs/debug/runs/2024-03-08_19-32-05
[2024-03-08 19:40:45,826][src.utils.utils][INFO] - Closing loggers...
